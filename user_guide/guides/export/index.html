
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://mbsantiago.github.io/whombat/user_guide/guides/export/">
      
      
        <link rel="prev" href="../spectrogram_display/">
      
      
        <link rel="next" href="../../faq/">
      
      
      <link rel="icon" href="../../../assets/favicon.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>Export Annotations for ML Development - Whombat</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Mulish:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Mulish";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../stylesheets/jquery.json-viewer.css">
    
      <link rel="stylesheet" href="../../../css/mkdocstrings.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#export-annotations-for-ml-development" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Whombat" class="md-header__button md-logo" aria-label="Whombat" data-md-component="logo">
      
  <img src="../../../assets/logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Whombat
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Export Annotations for ML Development
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/mbsantiago/whombat" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
  
    
  
  User Guide

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../developer_guide/" class="md-tabs__link">
          
  
  
    
  
  Developer Guide

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../reference/models/" class="md-tabs__link">
          
  
  
    
  
  Reference

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../AUTHORS/" class="md-tabs__link">
          
  
  
    
  
  About the Project

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Whombat" class="md-nav__button md-logo" aria-label="Whombat" data-md-component="logo">
      
  <img src="../../../assets/logo.svg" alt="logo">

    </a>
    Whombat
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/mbsantiago/whombat" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    User Guide
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../datasets/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Managing Datasets
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../annotation_projects/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Creating Annotation Projects
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Evaluating Predictions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../exploration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Exploring Your Data
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_7" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Practical Guides & Advanced Use Cases
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_7" id="__nav_2_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_7">
            <span class="md-nav__icon md-icon"></span>
            Practical Guides & Advanced Use Cases
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../import/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Importing Data into Whombat
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../spectrogram_display/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Visualizing Audio with the Spectrogram
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Export Annotations for ML Development
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Export Annotations for ML Development
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#data-formats" class="md-nav__link">
    <span class="md-ellipsis">
      Data formats
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exporting-your-work-from-whombat" class="md-nav__link">
    <span class="md-ellipsis">
      Exporting Your Work from Whombat
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-export" class="md-nav__link">
    <span class="md-ellipsis">
      How to Export
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#loading-annotations-with-soundevent" class="md-nav__link">
    <span class="md-ellipsis">
      Loading Annotations with soundevent
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-cleaning-and-preprocessing" class="md-nav__link">
    <span class="md-ellipsis">
      Data Cleaning and Preprocessing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#preparing-for-model-training-train-test-split-and-evaluation-set" class="md-nav__link">
    <span class="md-ellipsis">
      Preparing for Model Training: Train-Test Split and Evaluation Set
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Preparing for Model Training: Train-Test Split and Evaluation Set">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#splitting-into-training-and-testing-sets" class="md-nav__link">
    <span class="md-ellipsis">
      Splitting into Training and Testing Sets
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-an-evaluation-set" class="md-nav__link">
    <span class="md-ellipsis">
      Creating an Evaluation Set
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-a-simple-classifier-with-features" class="md-nav__link">
    <span class="md-ellipsis">
      Create a Simple Classifier with Features
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Create a Simple Classifier with Features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#collecting-training-data" class="md-nav__link">
    <span class="md-ellipsis">
      Collecting Training Data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extracting-features" class="md-nav__link">
    <span class="md-ellipsis">
      Extracting Features
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extracting-species-labels" class="md-nav__link">
    <span class="md-ellipsis">
      Extracting Species Labels
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#model-training" class="md-nav__link">
    <span class="md-ellipsis">
      Model Training
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generating-predictions" class="md-nav__link">
    <span class="md-ellipsis">
      Generating Predictions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#saving-model-predictions" class="md-nav__link">
    <span class="md-ellipsis">
      Saving Model Predictions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evaluating-the-model" class="md-nav__link">
    <span class="md-ellipsis">
      Evaluating the Model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#analyzing-the-results" class="md-nav__link">
    <span class="md-ellipsis">
      Analyzing the Results
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sharing-the-evaluation" class="md-nav__link">
    <span class="md-ellipsis">
      Sharing the Evaluation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusions" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusions
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FAQ
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../developer_guide/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Developer Guide
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Developer Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../developer_guide/quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quickstart
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../CONTRIBUTING/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../CODE_OF_CONDUCT/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Code of Conduct
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Models
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Python API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/schemas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Schemas
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    About the Project
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            About the Project
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../AUTHORS/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Authors
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../sponsors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sponsors
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#data-formats" class="md-nav__link">
    <span class="md-ellipsis">
      Data formats
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exporting-your-work-from-whombat" class="md-nav__link">
    <span class="md-ellipsis">
      Exporting Your Work from Whombat
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-export" class="md-nav__link">
    <span class="md-ellipsis">
      How to Export
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#loading-annotations-with-soundevent" class="md-nav__link">
    <span class="md-ellipsis">
      Loading Annotations with soundevent
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-cleaning-and-preprocessing" class="md-nav__link">
    <span class="md-ellipsis">
      Data Cleaning and Preprocessing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#preparing-for-model-training-train-test-split-and-evaluation-set" class="md-nav__link">
    <span class="md-ellipsis">
      Preparing for Model Training: Train-Test Split and Evaluation Set
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Preparing for Model Training: Train-Test Split and Evaluation Set">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#splitting-into-training-and-testing-sets" class="md-nav__link">
    <span class="md-ellipsis">
      Splitting into Training and Testing Sets
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-an-evaluation-set" class="md-nav__link">
    <span class="md-ellipsis">
      Creating an Evaluation Set
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-a-simple-classifier-with-features" class="md-nav__link">
    <span class="md-ellipsis">
      Create a Simple Classifier with Features
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Create a Simple Classifier with Features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#collecting-training-data" class="md-nav__link">
    <span class="md-ellipsis">
      Collecting Training Data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extracting-features" class="md-nav__link">
    <span class="md-ellipsis">
      Extracting Features
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extracting-species-labels" class="md-nav__link">
    <span class="md-ellipsis">
      Extracting Species Labels
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#model-training" class="md-nav__link">
    <span class="md-ellipsis">
      Model Training
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generating-predictions" class="md-nav__link">
    <span class="md-ellipsis">
      Generating Predictions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#saving-model-predictions" class="md-nav__link">
    <span class="md-ellipsis">
      Saving Model Predictions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evaluating-the-model" class="md-nav__link">
    <span class="md-ellipsis">
      Evaluating the Model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#analyzing-the-results" class="md-nav__link">
    <span class="md-ellipsis">
      Analyzing the Results
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sharing-the-evaluation" class="md-nav__link">
    <span class="md-ellipsis">
      Sharing the Evaluation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusions" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusions
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="export-annotations-for-ml-development">Export Annotations for ML Development<a class="headerlink" href="#export-annotations-for-ml-development" title="Permanent link">&para;</a></h1>
<p><strong>Whombat</strong> is degined to facilitate the generation of high-quality labeled audio data.
But the real utility comes from using that data to train machine learning models.
This guide will show you how to take your Whombat annotations and build a simple species classifier in Python</p>
<h2 id="data-formats">Data formats<a class="headerlink" href="#data-formats" title="Permanent link">&para;</a></h2>
<p>Before we dive into the practical steps, let's take a moment to understand the importance of data formats in audio annotation.
The bioacoustics field employs various formats, such as Praat text files, Audacity annotations, and Raven annotations.
While these formats serve their purpose, they often present limitations:</p>
<ol>
<li>They don't export all necessary metadata, such as recording info, tags, and user actions.</li>
<li>They lack information on annotation completeness and can't indicate if a clip or whole recording was annotated.</li>
<li>They have rigid ways of representing the ROI of a sound event.</li>
</ol>
<p>To overcome these challenges and ensure that your valuable annotation data is fully preserved and readily usable for machine learning, Whombat utilizes a custom format called the Acoustic Object Exchange Format (AOEF).
This JSON-based format retains all the essential data and rich metadata required for effective model development.</p>
<h2 id="exporting-your-work-from-whombat">Exporting Your Work from Whombat<a class="headerlink" href="#exporting-your-work-from-whombat" title="Permanent link">&para;</a></h2>
<p><strong>Whombat</strong> provides a convenient way to export your work, allowing you to share data and collaborate with others.
You can export various types of information:</p>
<ul>
<li><strong>Datasets</strong>: Share the meticulously curated metadata of your recordings with colleagues or collaborators.</li>
<li><strong>Annotation Projects</strong>: Export complete annotation projects, including all annotations, user information, timestamps, and annotation statuses.
    This provides a comprehensive record of the annotation process.</li>
<li><strong>Evaluation Sets</strong>: Share predefined evaluation sets, containing specific clips and target sounds, to ensure standardized model evaluation and comparison across different teams or researchers.</li>
<li><strong>Evaluations</strong>: Download the results of model evaluations.
    This includes overall scores, detailed metrics, and a breakdown of individual predictions, facilitating in-depth analysis and transparent reporting of model performance.</li>
</ul>
<h2 id="how-to-export">How to Export<a class="headerlink" href="#how-to-export" title="Permanent link">&para;</a></h2>
<p>Exporting your data from Whombat is a straightforward process:</p>
<ol>
<li><strong>Navigate to the Detail View</strong>: Open the detail view of the dataset, annotation project, evaluation set, or evaluation that you wish to export.</li>
<li><strong>Click "Download"</strong>: In the top right section of the page, you'll find a "Download" button.
      Click this button to initiate the download process.</li>
<li><strong>Wait for File Preparation</strong>: Whombat will prepare the export file, which may take a few seconds depending on the size of the data.</li>
<li><strong>Access the Downloaded File</strong>: Once the download is complete, the file will be saved to your designated "Downloads" folder.</li>
</ol>
<p>Exported files will have a descriptive filename.
For example, a downloaded dataset might have a name like: <code>dataset-3u98gjp294rn9p8sd.json</code></p>
<p>The unique ID following the hyphen identifies the specific dataset.
Each exported file also includes information about the export timestamp, allowing you to keep track of different versions.</p>
<h2 id="loading-annotations-with-soundevent">Loading Annotations with <code>soundevent</code><a class="headerlink" href="#loading-annotations-with-soundevent" title="Permanent link">&para;</a></h2>
<p>The <code>soundevent</code> library is a helpful tool for working with audio annotation data in Python.
It provides convenient functions for loading, manipulating, and analysing the annotated audio files as exported from Whombat.
We'll use it to load the exported JSON file from Whombat into a <code>soundevent.data.AnnotationProject</code> object.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">soundevent</span><span class="w"> </span><span class="kn">import</span> <span class="n">data</span><span class="p">,</span> <span class="n">io</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="n">annotation_project</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;example_annotation_project.json&quot;</span><span class="p">)</span>
</span></code></pre></div>
<p>This <code>AnnotationProject</code> object mirrors how Whombat organizes annotation data in its database.
Let's explore its contents:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c1"># See how many annotation tasks are in the project</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Annotation tasks &quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">annotation_project</span><span class="o">.</span><span class="n">tasks</span><span class="p">))</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="c1"># Check the number of annotation tags used</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Annotation tags: &quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">annotation_project</span><span class="o">.</span><span class="n">annotation_tags</span><span class="p">))</span>
</span></code></pre></div>
<h2 id="data-cleaning-and-preprocessing">Data Cleaning and Preprocessing<a class="headerlink" href="#data-cleaning-and-preprocessing" title="Permanent link">&para;</a></h2>
<p>Before we start building our classifier, it's essential to clean up our data.
This involves removing any incomplete or problematic annotations that could negatively impact the model's performance.</p>
<p>In this example, we'll filter out tasks that are not marked as complete or have associated issues.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">task_is_complete</span><span class="p">(</span><span class="n">task</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">AnnotationTask</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if an annotation task is complete.</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="sd">    A task is considered complete if it has a &#39;completed&#39; status badge</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="sd">    and does not have a &#39;rejected&#39; badge (indicating it needs review).</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>    <span class="k">for</span> <span class="n">badge</span> <span class="ow">in</span> <span class="n">task</span><span class="o">.</span><span class="n">status_badges</span><span class="p">:</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>        <span class="k">if</span> <span class="n">badge</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="n">data</span><span class="o">.</span><span class="n">AnnotationState</span><span class="o">.</span><span class="n">rejected</span><span class="p">:</span>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>            <span class="c1"># Task needs review, so it&#39;s not considered complete.</span>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>        <span class="k">if</span> <span class="n">badge</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="n">data</span><span class="o">.</span><span class="n">AnnotationState</span><span class="o">.</span><span class="n">completed</span><span class="p">:</span>
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>            <span class="c1"># Task is explicitly marked as complete.</span>
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a>
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a>    <span class="c1"># If no &#39;completed&#39; badge is found, the task is not complete.</span>
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a>    <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-2-18"><a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a>
</span><span id="__span-2-19"><a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a>
</span><span id="__span-2-20"><a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a><span class="c1"># Create a dictionary mapping clip UUIDs to their completion status.</span>
</span><span id="__span-2-21"><a id="__codelineno-2-21" name="__codelineno-2-21" href="#__codelineno-2-21"></a><span class="n">clip_status</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-2-22"><a id="__codelineno-2-22" name="__codelineno-2-22" href="#__codelineno-2-22"></a>    <span class="n">task</span><span class="o">.</span><span class="n">clip</span><span class="o">.</span><span class="n">uuid</span><span class="p">:</span> <span class="n">task_is_complete</span><span class="p">(</span><span class="n">task</span><span class="p">)</span>
</span><span id="__span-2-23"><a id="__codelineno-2-23" name="__codelineno-2-23" href="#__codelineno-2-23"></a>    <span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="n">annotation_project</span><span class="o">.</span><span class="n">tasks</span>
</span><span id="__span-2-24"><a id="__codelineno-2-24" name="__codelineno-2-24" href="#__codelineno-2-24"></a><span class="p">}</span>
</span><span id="__span-2-25"><a id="__codelineno-2-25" name="__codelineno-2-25" href="#__codelineno-2-25"></a>
</span><span id="__span-2-26"><a id="__codelineno-2-26" name="__codelineno-2-26" href="#__codelineno-2-26"></a>
</span><span id="__span-2-27"><a id="__codelineno-2-27" name="__codelineno-2-27" href="#__codelineno-2-27"></a><span class="k">def</span><span class="w"> </span><span class="nf">clip_annotation_is_complete</span><span class="p">(</span><span class="n">annotation</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">ClipAnnotation</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="__span-2-28"><a id="__codelineno-2-28" name="__codelineno-2-28" href="#__codelineno-2-28"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if a clip annotation is complete based on its task status.&quot;&quot;&quot;</span>
</span><span id="__span-2-29"><a id="__codelineno-2-29" name="__codelineno-2-29" href="#__codelineno-2-29"></a>    <span class="k">if</span> <span class="n">annotation</span><span class="o">.</span><span class="n">clip</span><span class="o">.</span><span class="n">uuid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">clip_status</span><span class="p">:</span>
</span><span id="__span-2-30"><a id="__codelineno-2-30" name="__codelineno-2-30" href="#__codelineno-2-30"></a>        <span class="c1"># If the clip is not part of the project&#39;s tasks, ignore it.</span>
</span><span id="__span-2-31"><a id="__codelineno-2-31" name="__codelineno-2-31" href="#__codelineno-2-31"></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-2-32"><a id="__codelineno-2-32" name="__codelineno-2-32" href="#__codelineno-2-32"></a>
</span><span id="__span-2-33"><a id="__codelineno-2-33" name="__codelineno-2-33" href="#__codelineno-2-33"></a>    <span class="c1"># Return the pre-computed completion status from the clip_status dictionary.</span>
</span><span id="__span-2-34"><a id="__codelineno-2-34" name="__codelineno-2-34" href="#__codelineno-2-34"></a>    <span class="k">return</span> <span class="n">clip_status</span><span class="p">[</span><span class="n">annotation</span><span class="o">.</span><span class="n">clip</span><span class="o">.</span><span class="n">uuid</span><span class="p">]</span>
</span><span id="__span-2-35"><a id="__codelineno-2-35" name="__codelineno-2-35" href="#__codelineno-2-35"></a>
</span><span id="__span-2-36"><a id="__codelineno-2-36" name="__codelineno-2-36" href="#__codelineno-2-36"></a>
</span><span id="__span-2-37"><a id="__codelineno-2-37" name="__codelineno-2-37" href="#__codelineno-2-37"></a><span class="k">def</span><span class="w"> </span><span class="nf">clip_annotation_has_issues</span><span class="p">(</span><span class="n">annotation</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">ClipAnnotation</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="__span-2-38"><a id="__codelineno-2-38" name="__codelineno-2-38" href="#__codelineno-2-38"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if a clip annotation has any associated issues.&quot;&quot;&quot;</span>
</span><span id="__span-2-39"><a id="__codelineno-2-39" name="__codelineno-2-39" href="#__codelineno-2-39"></a>    <span class="k">return</span> <span class="nb">any</span><span class="p">(</span><span class="n">note</span><span class="o">.</span><span class="n">is_issue</span> <span class="k">for</span> <span class="n">note</span> <span class="ow">in</span> <span class="n">annotation</span><span class="o">.</span><span class="n">notes</span><span class="p">)</span>
</span><span id="__span-2-40"><a id="__codelineno-2-40" name="__codelineno-2-40" href="#__codelineno-2-40"></a>
</span><span id="__span-2-41"><a id="__codelineno-2-41" name="__codelineno-2-41" href="#__codelineno-2-41"></a>
</span><span id="__span-2-42"><a id="__codelineno-2-42" name="__codelineno-2-42" href="#__codelineno-2-42"></a><span class="c1"># Filter the clip annotations to include only those that are complete and have</span>
</span><span id="__span-2-43"><a id="__codelineno-2-43" name="__codelineno-2-43" href="#__codelineno-2-43"></a><span class="c1"># no issues.</span>
</span><span id="__span-2-44"><a id="__codelineno-2-44" name="__codelineno-2-44" href="#__codelineno-2-44"></a><span class="n">annotated_clips</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-2-45"><a id="__codelineno-2-45" name="__codelineno-2-45" href="#__codelineno-2-45"></a>    <span class="n">annotation</span>
</span><span id="__span-2-46"><a id="__codelineno-2-46" name="__codelineno-2-46" href="#__codelineno-2-46"></a>    <span class="k">for</span> <span class="n">annotation</span> <span class="ow">in</span> <span class="n">annotation_project</span><span class="o">.</span><span class="n">clip_annotations</span>
</span><span id="__span-2-47"><a id="__codelineno-2-47" name="__codelineno-2-47" href="#__codelineno-2-47"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">clip_annotation_has_issues</span><span class="p">(</span><span class="n">annotation</span><span class="p">)</span>
</span><span id="__span-2-48"><a id="__codelineno-2-48" name="__codelineno-2-48" href="#__codelineno-2-48"></a>    <span class="ow">and</span> <span class="n">clip_annotation_is_complete</span><span class="p">(</span><span class="n">annotation</span><span class="p">)</span>
</span><span id="__span-2-49"><a id="__codelineno-2-49" name="__codelineno-2-49" href="#__codelineno-2-49"></a><span class="p">]</span>
</span></code></pre></div>
<h2 id="preparing-for-model-training-train-test-split-and-evaluation-set">Preparing for Model Training: Train-Test Split and Evaluation Set<a class="headerlink" href="#preparing-for-model-training-train-test-split-and-evaluation-set" title="Permanent link">&para;</a></h2>
<p>Now that we have a clean set of annotated clips, let's prepare the data for training a machine learning model.
This involves two key steps:</p>
<ul>
<li><strong>Splitting the data into training and testing sets</strong>: This is crucial to evaluate how well our model generalizes to unseen data.</li>
<li><strong>Creating an evaluation set</strong>: This allows for standardized evaluation and comparison of different models.</li>
</ul>
<h3 id="splitting-into-training-and-testing-sets">Splitting into Training and Testing Sets<a class="headerlink" href="#splitting-into-training-and-testing-sets" title="Permanent link">&para;</a></h3>
<p>This annotation project focuses on classifying bat species based on their echolocation calls.
However, there's a limitation: each species is represented by only one recording.
Ideally, we'd have multiple recordings per species to ensure a more robust and representative split.
While this isn't the case here, we'll proceed with the example for illustration purposes.</p>
<p>First, we'll extract the species information from each <code>ClipAnnotation</code> object.
Remember that each clip is derived from a longer recording, and the recording has associated tags, including the species.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="n">example_annotation</span> <span class="o">=</span> <span class="n">annotated_clips</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="n">recording</span> <span class="o">=</span> <span class="n">example_annotation</span><span class="o">.</span><span class="n">clip</span><span class="o">.</span><span class="n">recording</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">recording</span><span class="o">.</span><span class="n">tags</span><span class="p">:</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>    <span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">tag</span><span class="p">))</span>
</span></code></pre></div>
<p>Next, we'll determine the species of each clip and count how many examples we have per species.
To avoid issues with species having only one example, we'll exclude those for now.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">Counter</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="n">y_true</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>    <span class="n">data</span><span class="o">.</span><span class="n">find_tag</span><span class="p">(</span><span class="n">annotation</span><span class="o">.</span><span class="n">clip</span><span class="o">.</span><span class="n">recording</span><span class="o">.</span><span class="n">tags</span><span class="p">,</span> <span class="s2">&quot;species&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>    <span class="k">for</span> <span class="n">annotation</span> <span class="ow">in</span> <span class="n">annotated_clips</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="p">]</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="n">examples_per_species</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="n">annotated_clips</span><span class="p">,</span> <span class="n">y_true</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a>    <span class="o">*</span><span class="p">[</span>
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a>        <span class="p">(</span><span class="n">annotation</span><span class="p">,</span> <span class="n">species</span><span class="p">)</span>
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a>        <span class="k">for</span> <span class="n">annotation</span><span class="p">,</span> <span class="n">species</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">annotated_clips</span><span class="p">,</span> <span class="n">y_true</span><span class="p">)</span>
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a>        <span class="k">if</span> <span class="n">examples_per_species</span><span class="p">[</span><span class="n">species</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span>
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a>    <span class="p">]</span>
</span><span id="__span-4-16"><a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a><span class="p">)</span>
</span></code></pre></div>
<p>We'll use the <code>train_test_split</code> function from scikit-learn to divide our data.
We'll perform a stratified split based on species to ensure a balanced representation in both training and testing sets.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="n">seed</span> <span class="o">=</span> <span class="mi">42</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="n">train_clips</span><span class="p">,</span> <span class="n">test_clips</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>    <span class="n">annotated_clips</span><span class="p">,</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>    <span class="n">y_true</span><span class="p">,</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>    <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>  <span class="c1"># 30 % of the data will be used for testing</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>    <span class="n">stratify</span><span class="o">=</span><span class="n">y_true</span><span class="p">,</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a>    <span class="n">random_state</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="p">)</span>
</span></code></pre></div>
<h3 id="creating-an-evaluation-set">Creating an Evaluation Set<a class="headerlink" href="#creating-an-evaluation-set" title="Permanent link">&para;</a></h3>
<p>An evaluation set allows us to assess the performance of our trained model on a held-out portion of the data.
This set can be saved to a file and shared, enabling others to evaluate their models on the same data and compare results.</p>
<p>To create an evaluation set, we need to define:</p>
<ul>
<li><strong>Target sounds</strong>: The specific sounds or categories we want to evaluate.
    In this case, our target is the "species" tag.</li>
<li><strong>Examples</strong>: The specific annotated clips that will be used for evaluation.
    Here, we'll use the <code>test_clips</code> we created earlier.</li>
</ul>
<div class="language-python highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="n">evaluation_tags</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>    <span class="n">data</span><span class="o">.</span><span class="n">find_tag</span><span class="p">(</span><span class="n">annotation</span><span class="o">.</span><span class="n">clip</span><span class="o">.</span><span class="n">recording</span><span class="o">.</span><span class="n">tags</span><span class="p">,</span> <span class="s2">&quot;species&quot;</span><span class="p">)</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>    <span class="k">for</span> <span class="n">annotation</span> <span class="ow">in</span> <span class="n">test_clips</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="p">}</span>
</span></code></pre></div>
<p>Now, let's construct the EvaluationSet object.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">uuid</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="c1"># Ignore this bit, it is just to make sure the uuid is unique but still</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="c1"># deterministic</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="n">namespace</span> <span class="o">=</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid5</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">NAMESPACE_DNS</span><span class="p">,</span> <span class="s2">&quot;whombat&quot;</span><span class="p">)</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="n">evaluation_set_uuid</span> <span class="o">=</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid5</span><span class="p">(</span><span class="n">namespace</span><span class="p">,</span> <span class="s2">&quot;Example Evaluation Set&quot;</span><span class="p">)</span>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="c1"># Now we can define the evaluation set</span>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a><span class="n">evaluation_set</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">EvaluationSet</span><span class="p">(</span>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a>    <span class="n">uuid</span><span class="o">=</span><span class="n">evaluation_set_uuid</span><span class="p">,</span>
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a>    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Example evaluation set&quot;</span><span class="p">,</span>
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a>    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Example evaluation set for species classification&quot;</span><span class="p">,</span>
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a>    <span class="n">clip_annotations</span><span class="o">=</span><span class="n">test_clips</span><span class="p">,</span>
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a>    <span class="n">evaluation_tags</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">evaluation_tags</span><span class="p">),</span>
</span><span id="__span-7-15"><a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a><span class="p">)</span>
</span></code></pre></div>
<p>Finally, we can save the evaluation set to a JSON file.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="n">io</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">evaluation_set</span><span class="p">,</span> <span class="s2">&quot;example_evaluation_set.json&quot;</span><span class="p">)</span>
</span></code></pre></div>
<p>This saved file can be easily loaded back into Python or even imported back into <strong>Whombat</strong>, allowing you to upload and analyze model predictions on this standardized evaluation set.</p>
<h2 id="create-a-simple-classifier-with-features">Create a Simple Classifier with Features<a class="headerlink" href="#create-a-simple-classifier-with-features" title="Permanent link">&para;</a></h2>
<p>In this section, we'll create a basic bat species classifier using manually engineered acoustic features.
This approach, common before the deep learning era, involves extracting specific features from echolocation calls and using them to train a machine learning model.</p>
<p>We'll use three readily available features from our annotated data:</p>
<ul>
<li><strong>Duration</strong>: The length of the echolocation call.</li>
<li><strong>Lowest Frequency</strong>: The lowest frequency present in the call.</li>
<li><strong>Highest Frequency</strong>: The highest frequency present in the call.</li>
</ul>
<p>These features can be derived directly from the bounding boxes we've annotated around each call.
Our classifier will attempt to predict the species of a bat based on these features.</p>
<h3 id="collecting-training-data">Collecting Training Data<a class="headerlink" href="#collecting-training-data" title="Permanent link">&para;</a></h3>
<p>First, let's gather all the annotated sound events from our training set.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="n">train_sound_events</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>    <span class="n">sound_event_annotation</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>    <span class="k">for</span> <span class="n">clip_annotation</span> <span class="ow">in</span> <span class="n">train_clips</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>    <span class="k">for</span> <span class="n">sound_event_annotation</span> <span class="ow">in</span> <span class="n">clip_annotation</span><span class="o">.</span><span class="n">sound_events</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="p">]</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">train_sound_events</span><span class="p">))</span>
</span></code></pre></div>
<h3 id="extracting-features">Extracting Features<a class="headerlink" href="#extracting-features" title="Permanent link">&para;</a></h3>
<p>Now for each annotated sound event we will get all the features.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_features</span><span class="p">(</span><span class="n">sound_event</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">SoundEvent</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="sd">    Extract acoustic features from a SoundEvent object.</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>    <span class="k">return</span> <span class="p">(</span>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>        <span class="n">data</span><span class="o">.</span><span class="n">find_feature</span><span class="p">(</span><span class="n">sound_event</span><span class="o">.</span><span class="n">features</span><span class="p">,</span> <span class="s2">&quot;duration&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a>        <span class="n">data</span><span class="o">.</span><span class="n">find_feature</span><span class="p">(</span><span class="n">sound_event</span><span class="o">.</span><span class="n">features</span><span class="p">,</span> <span class="s2">&quot;low_freq&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a>        <span class="n">data</span><span class="o">.</span><span class="n">find_feature</span><span class="p">(</span><span class="n">sound_event</span><span class="o">.</span><span class="n">features</span><span class="p">,</span> <span class="s2">&quot;high_freq&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a>    <span class="p">)</span>
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a>
</span><span id="__span-10-11"><a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a>
</span><span id="__span-10-12"><a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a><span class="n">X_train</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-10-13"><a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a>    <span class="n">get_features</span><span class="p">(</span><span class="n">annotation</span><span class="o">.</span><span class="n">sound_event</span><span class="p">)</span>
</span><span id="__span-10-14"><a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a>    <span class="k">for</span> <span class="n">annotation</span> <span class="ow">in</span> <span class="n">train_sound_events</span>
</span><span id="__span-10-15"><a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a><span class="p">]</span>
</span></code></pre></div>
<h3 id="extracting-species-labels">Extracting Species Labels<a class="headerlink" href="#extracting-species-labels" title="Permanent link">&para;</a></h3>
<p>Now, let's extract the corresponding species label for each sound event.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="n">y_train</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>    <span class="n">data</span><span class="o">.</span><span class="n">find_tag</span><span class="p">(</span><span class="n">annotation</span><span class="o">.</span><span class="n">tags</span><span class="p">,</span> <span class="s2">&quot;species&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>    <span class="k">for</span> <span class="n">annotation</span> <span class="ow">in</span> <span class="n">train_sound_events</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="p">]</span>
</span></code></pre></div>
<h3 id="model-training">Model Training<a class="headerlink" href="#model-training" title="Permanent link">&para;</a></h3>
<p>With our features and labels prepared, we can now train a simple classifier.
We'll use a linear Support Vector Machine (SVM) for this purpose.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.svm</span><span class="w"> </span><span class="kn">import</span> <span class="n">SVC</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="n">seed</span> <span class="o">=</span> <span class="mi">42</span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="n">model</span> <span class="o">=</span> <span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</span></code></pre></div>
<h3 id="generating-predictions">Generating Predictions<a class="headerlink" href="#generating-predictions" title="Permanent link">&para;</a></h3>
<p>Let's use our trained model to predict the species of calls in the evaluation set.
For each clip, we'll iterate through the annotated sound events, extract the features, and use the model to predict the species.
We'll then attach this prediction as a <code>PredictedTag</code> to the sound event.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="n">model_run_uuid</span> <span class="o">=</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid5</span><span class="p">(</span><span class="n">namespace</span><span class="p">,</span> <span class="s2">&quot;Example Model Run (Features)&quot;</span><span class="p">)</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="k">def</span><span class="w"> </span><span class="nf">predict_sound_event</span><span class="p">(</span><span class="n">sound_event</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">SoundEvent</span><span class="p">):</span>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="sd">    Predict the species of a sound event and create a SoundEventPrediction.</span>
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-13-8"><a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a>    <span class="n">features</span> <span class="o">=</span> <span class="n">get_features</span><span class="p">(</span><span class="n">sound_event</span><span class="p">)</span>
</span><span id="__span-13-9"><a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a>    <span class="n">species</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">([</span><span class="n">features</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-13-10"><a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a>    <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">SoundEventPrediction</span><span class="p">(</span>
</span><span id="__span-13-11"><a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a>        <span class="n">tags</span><span class="o">=</span><span class="p">[</span>
</span><span id="__span-13-12"><a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a>            <span class="n">data</span><span class="o">.</span><span class="n">PredictedTag</span><span class="p">(</span>
</span><span id="__span-13-13"><a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a>                <span class="n">tag</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">Tag</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s2">&quot;species&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">species</span><span class="p">),</span>
</span><span id="__span-13-14"><a id="__codelineno-13-14" name="__codelineno-13-14" href="#__codelineno-13-14"></a>                <span class="n">score</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="__span-13-15"><a id="__codelineno-13-15" name="__codelineno-13-15" href="#__codelineno-13-15"></a>            <span class="p">)</span>
</span><span id="__span-13-16"><a id="__codelineno-13-16" name="__codelineno-13-16" href="#__codelineno-13-16"></a>        <span class="p">],</span>
</span><span id="__span-13-17"><a id="__codelineno-13-17" name="__codelineno-13-17" href="#__codelineno-13-17"></a>        <span class="n">sound_event</span><span class="o">=</span><span class="n">sound_event</span><span class="p">,</span>
</span><span id="__span-13-18"><a id="__codelineno-13-18" name="__codelineno-13-18" href="#__codelineno-13-18"></a>        <span class="n">uuid</span><span class="o">=</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid5</span><span class="p">(</span><span class="n">model_run_uuid</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;sound_event_prediction_</span><span class="si">{</span><span class="n">sound_event</span><span class="o">.</span><span class="n">uuid</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">),</span>
</span><span id="__span-13-19"><a id="__codelineno-13-19" name="__codelineno-13-19" href="#__codelineno-13-19"></a>    <span class="p">)</span>
</span><span id="__span-13-20"><a id="__codelineno-13-20" name="__codelineno-13-20" href="#__codelineno-13-20"></a>
</span><span id="__span-13-21"><a id="__codelineno-13-21" name="__codelineno-13-21" href="#__codelineno-13-21"></a>
</span><span id="__span-13-22"><a id="__codelineno-13-22" name="__codelineno-13-22" href="#__codelineno-13-22"></a><span class="k">def</span><span class="w"> </span><span class="nf">process_clip</span><span class="p">(</span><span class="n">clip_annotation</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">ClipAnnotation</span><span class="p">):</span>
</span><span id="__span-13-23"><a id="__codelineno-13-23" name="__codelineno-13-23" href="#__codelineno-13-23"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-13-24"><a id="__codelineno-13-24" name="__codelineno-13-24" href="#__codelineno-13-24"></a><span class="sd">    Generate predictions for all sound events in a clip.</span>
</span><span id="__span-13-25"><a id="__codelineno-13-25" name="__codelineno-13-25" href="#__codelineno-13-25"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-13-26"><a id="__codelineno-13-26" name="__codelineno-13-26" href="#__codelineno-13-26"></a>    <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">ClipPrediction</span><span class="p">(</span>
</span><span id="__span-13-27"><a id="__codelineno-13-27" name="__codelineno-13-27" href="#__codelineno-13-27"></a>        <span class="n">clip</span><span class="o">=</span><span class="n">clip_annotation</span><span class="o">.</span><span class="n">clip</span><span class="p">,</span>
</span><span id="__span-13-28"><a id="__codelineno-13-28" name="__codelineno-13-28" href="#__codelineno-13-28"></a>        <span class="n">sound_events</span><span class="o">=</span><span class="p">[</span>
</span><span id="__span-13-29"><a id="__codelineno-13-29" name="__codelineno-13-29" href="#__codelineno-13-29"></a>            <span class="n">predict_sound_event</span><span class="p">(</span><span class="n">annotation</span><span class="o">.</span><span class="n">sound_event</span><span class="p">)</span>
</span><span id="__span-13-30"><a id="__codelineno-13-30" name="__codelineno-13-30" href="#__codelineno-13-30"></a>            <span class="k">for</span> <span class="n">annotation</span> <span class="ow">in</span> <span class="n">clip_annotation</span><span class="o">.</span><span class="n">sound_events</span>
</span><span id="__span-13-31"><a id="__codelineno-13-31" name="__codelineno-13-31" href="#__codelineno-13-31"></a>        <span class="p">],</span>
</span><span id="__span-13-32"><a id="__codelineno-13-32" name="__codelineno-13-32" href="#__codelineno-13-32"></a>        <span class="n">uuid</span><span class="o">=</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid5</span><span class="p">(</span><span class="n">model_run_uuid</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;clip_prediction_</span><span class="si">{</span><span class="n">clip_annotation</span><span class="o">.</span><span class="n">uuid</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">),</span>
</span><span id="__span-13-33"><a id="__codelineno-13-33" name="__codelineno-13-33" href="#__codelineno-13-33"></a>    <span class="p">)</span>
</span><span id="__span-13-34"><a id="__codelineno-13-34" name="__codelineno-13-34" href="#__codelineno-13-34"></a>
</span><span id="__span-13-35"><a id="__codelineno-13-35" name="__codelineno-13-35" href="#__codelineno-13-35"></a>
</span><span id="__span-13-36"><a id="__codelineno-13-36" name="__codelineno-13-36" href="#__codelineno-13-36"></a><span class="n">predictions</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-13-37"><a id="__codelineno-13-37" name="__codelineno-13-37" href="#__codelineno-13-37"></a>    <span class="n">process_clip</span><span class="p">(</span><span class="n">clip_annotation</span><span class="p">)</span>
</span><span id="__span-13-38"><a id="__codelineno-13-38" name="__codelineno-13-38" href="#__codelineno-13-38"></a>    <span class="k">for</span> <span class="n">clip_annotation</span> <span class="ow">in</span> <span class="n">evaluation_set</span><span class="o">.</span><span class="n">clip_annotations</span>
</span><span id="__span-13-39"><a id="__codelineno-13-39" name="__codelineno-13-39" href="#__codelineno-13-39"></a><span class="p">]</span>
</span></code></pre></div>
<h3 id="saving-model-predictions">Saving Model Predictions<a class="headerlink" href="#saving-model-predictions" title="Permanent link">&para;</a></h3>
<p>We can now store these predictions in a <code>ModelRun</code> object and save it to a file.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="n">model_run</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">ModelRun</span><span class="p">(</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>    <span class="n">uuid</span><span class="o">=</span><span class="n">model_run_uuid</span><span class="p">,</span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Support Vector Machine for Bats&quot;</span><span class="p">,</span>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>    <span class="c1"># Usually you will continue to improve your model so it is a good</span>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a>    <span class="c1"># idea to provide a version number</span>
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a>    <span class="n">version</span><span class="o">=</span><span class="s2">&quot;1.0&quot;</span><span class="p">,</span>
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a>    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Model run using manually engineered features&quot;</span><span class="p">,</span>
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a>    <span class="n">clip_predictions</span><span class="o">=</span><span class="n">predictions</span><span class="p">,</span>
</span><span id="__span-14-9"><a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a><span class="p">)</span>
</span><span id="__span-14-10"><a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a>
</span><span id="__span-14-11"><a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a><span class="n">io</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">model_run</span><span class="p">,</span> <span class="s2">&quot;example_model_run.json&quot;</span><span class="p">)</span>
</span></code></pre></div>
<p>This file can be imported into <strong>Whombat</strong> to visualize and analyze the model's predictions on the evaluation set.</p>
<h3 id="evaluating-the-model">Evaluating the Model<a class="headerlink" href="#evaluating-the-model" title="Permanent link">&para;</a></h3>
<p>Now that we have predictions from our bat species classifier, let's evaluate how well it performs.
We can use the <code>soundevent</code> library's <code>soundevent.evaluation.sound_event_detection</code> function to compare our model's predictions to the ground truth annotations in the evaluation set.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">soundevent</span><span class="w"> </span><span class="kn">import</span> <span class="n">evaluation</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="n">result</span> <span class="o">=</span> <span class="n">evaluation</span><span class="o">.</span><span class="n">sound_event_detection</span><span class="p">(</span>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a>    <span class="n">clip_predictions</span><span class="o">=</span><span class="n">model_run</span><span class="o">.</span><span class="n">clip_predictions</span><span class="p">,</span>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a>    <span class="n">clip_annotations</span><span class="o">=</span><span class="n">evaluation_set</span><span class="o">.</span><span class="n">clip_annotations</span><span class="p">,</span>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a>    <span class="n">tags</span><span class="o">=</span><span class="n">evaluation_set</span><span class="o">.</span><span class="n">evaluation_tags</span><span class="p">,</span>
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="p">)</span>
</span></code></pre></div>
<p>The sound_event_detection function is designed to assess a model's ability to both detect sound events (i.e., locate them in the audio) and classify them (i.e., assign the correct species label).
It works by trying to match predicted sound events to the annotated sound events and then evaluating the accuracy of the species predictions.</p>
<p>In our case, we've simplified the task by providing the model with the exact locations of the sound events.
Our model doesn't actually perform sound event detection; it only performs classification.
Think of it as if we've already perfectly detected the bat calls, and now we're just assessing how well the model can identify the species of each call.</p>
<p>Therefore, this evaluation primarily focuses on the species classification accuracy.
The <code>sound_event_detection</code> function will still attempt to match predictions to annotations, but since we've provided the locations, all annotations will be perfectly matched with a prediction.</p>
<h3 id="analyzing-the-results">Analyzing the Results<a class="headerlink" href="#analyzing-the-results" title="Permanent link">&para;</a></h3>
<p>The sound_event_detection function returns an Evaluation object, which provides a wealth of information about the model's performance:</p>
<ul>
<li><strong>Overall Score</strong>: A summary metric representing the overall performance.</li>
<li><strong>Additional Metrics</strong>: Other metrics like precision, recall, and F1-score, providing a more nuanced view of the model's capabilities.</li>
<li><strong>Example-by-Example Breakdown</strong>: A detailed analysis of how the model performed on each individual sound event, including which ones were misclassified.</li>
</ul>
<p>This detailed breakdown is incredibly valuable for understanding the model's strengths and weaknesses.
You can identify patterns in the misclassifications, which might reveal areas where the model struggles or where the features are not informative enough.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="c1"># Let&#39;s print out the overall score</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Overall score: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">score</span><span class="si">:</span><span class="s2">.2%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="c1"># And all the global metrics</span>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="k">for</span> <span class="n">metric</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">metrics</span><span class="p">:</span>
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;metric - </span><span class="si">{</span><span class="n">metric</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">metric</span><span class="o">.</span><span class="n">value</span><span class="si">:</span><span class="s2">.2%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></code></pre></div>
<h3 id="sharing-the-evaluation">Sharing the Evaluation<a class="headerlink" href="#sharing-the-evaluation" title="Permanent link">&para;</a></h3>
<p>The <code>Evaluation</code> object can also be saved to a file, which can be shared with others to provide transparency about the model's performance.
This allows others to see exactly where the model succeeded and where it failed, facilitating further analysis and comparison with other models.</p>
<h2 id="conclusions">Conclusions<a class="headerlink" href="#conclusions" title="Permanent link">&para;</a></h2>
<p>This guide has demonstrated how to leverage annotated audio data from Whombat to train a machine learning model for bat species classification.
We covered key steps, including loading and preprocessing annotation data, splitting data into training and testing sets, creating an evaluation set, extracting features, training a simple classifier, and evaluating its performance.</p>
<p>While our example focused on a basic classifier using manually engineered features, the underlying principles and workflow apply to more complex models and tasks.
You can adapt and extend these techniques to explore different feature extraction methods, experiment with various machine learning algorithms (including deep learning), and tackle diverse audio analysis challenges.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../spectrogram_display/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Visualizing Audio with the Spectrogram">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Visualizing Audio with the Spectrogram
              </div>
            </div>
          </a>
        
        
          
          <a href="../../faq/" class="md-footer__link md-footer__link--next" aria-label="Next: FAQ">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                FAQ
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/mbsantiago/whombat" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.copy", "navigation.footer", "navigation.indexes", "navigation.tabs", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../../../javascripts/jquery-3.3.1.min.js"></script>
      
        <script src="../../../javascripts/jquery.json-viewer.js"></script>
      
        <script src="../../../javascripts/json-viewer.js"></script>
      
    
  </body>
</html>